@import "tailwindcss" source("../");

@theme {
  --z-index-*: initial;
  --z-index-behind: -10;
  --z-index-base: 1;
  --z-index-sticky: 10;
  --z-index-nav-backdrop: 15;
  --z-index-side-drawer-backdrop: 15;
  --z-index-nav-menu: 20;
  --z-index-hover: 30;
  --z-index-nav-toggle: 40;
  --z-index-filter-footer: 40;
  --z-index-skip-link: 50;
  --z-index-search-backdrop: 50;
  --z-index-watchlist-overlay: 60;
  --z-index-filter-drawer: 80;
  --z-index-search-button: 1000;

  --background-color-*: initial;
  --background-color-accent: light-dark(#b4841e, #aa7f33);
  --background-color-calendar: light-dark(#fbfaf8, #393938);
  --background-color-canvas: light-dark(#f4f1ea, #484745);
  --background-color-default: light-dark(#fff, #322f2f);
  --background-color-footer: #2b292b;
  --background-color-inverse: light-dark(rgb(0 0 0 / 75%), #322f2f);
  --background-color-progress: light-dark(#14bd41, #379634);
  --background-color-sidenav: light-dark(#e3e2e2, #312f2f);
  --background-color-stripe: light-dark(#fcfcfc, #3c393a);
  --background-color-subtle: light-dark(#f9f7f4, #3e3d3c);
  --background-color-white: #fff;

  --border-color-*: initial;
  --border-color-default: var(--color-border);
  --border-color-slight: light-dark(#c2c1c1, #2a2828);

  --color-*: initial;
  --color-accent: light-dark(#bf8a00, #bf8a00);
  --color-border: light-dark(#e9e7e0, #484745);
  --color-default: light-dark(#252525, rgb(255 255 255 / 75%));
  --color-grey: #b0b0b0;
  --color-inherit: inherit;
  --color-muted: light-dark(#4a4a4a, rgb(255 255 255 / 65%));
  --color-subtle: light-dark(rgb(0 0 0 / 60%), #b2b0b0);
  --color-white: #fff;

  --tracking-*: initial;
  --tracking-normal: 0;
  --tracking-prose: 0.3px;
  --tracking-serif-wide: 0.6px;
  --tracking-wide: 0.8px;
  --tracking-wider: 1.1px;
  --tracking-widest: 2px;

  --breakpoint-*: initial;
  --breakpoint-tablet: 640px;
  --breakpoint-tablet-landscape: 1024px;
  --breakpoint-laptop: 1280px;
  --breakpoint-desktop: 1696px;

  --aspect-poster: 1 / 1.5;

  --shadow-all: 0 0 0 1px var(--color-border);
  --shadow-bottom: 0px 1px var(--color-border);
  --shadow-hover: 0 0 1px 1px var(--color-border);

  --font-sans: var(--font-sans);
  --font-serif: var(--font-serif);

  --text-2_5xl: 1.625rem;
  --text-md: 1.125rem;
  --text-md--line-height: 1.5rem;
  --text-xxs: 0.6875rem;

  --container-button: 430px;
  --container-popout: calc(64px + 39rem);
  --container-prose: 39rem;
  --container-unset: unset;

  --padding-container: var(--container-padding);
  --max-width-prose: 39rem;

  --width-list-item-poster: var(--list-item-poster-width);
}

@layer base {
  :root {
    --image-filter: initial;
    --container-padding: 8%;
    --font-sans: "Assistant";
    --font-serif: "FrankRuhlLibre";
    --list-item-poster-width: 64px;
    --hero-gradient: linear-gradient(
      to top,
      rgb(0 0 0 / 30%),
      rgb(0 0 0 / 10%) 20%,
      transparent 25%,
      transparent 80%,
      rgb(0 0 0 / 10%) 85%,
      rgb(0 0 0 / 30%) 100%
    );
    --drop-shadow-sm: 0 1px 2px rgb(0 0 0 / 15%);
    --drop-shadow-md: 0 3px 3px rgb(0 0 0 / 12%);
    --drop-shadow-2xl: 0 25px 25px rgb(0 0 0 / 15%);
    --drop-shadow-lg: 0 4px 4px rgb(0 0 0 / 15%);

    color-scheme: light dark;
  }

  body {
    font-family:
      FrankRuhlLibre, "Iowan Old Style", Georgia, Cambria, "Times New Roman",
      Times, serif;
    font-feature-settings: "kern", "liga", "clig", "calt", "ss06", "lnum";
    font-kerning: normal;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-weight: normal;
  }

  img {
    filter: var(--image-filter);
  }

  @media (prefers-contrast: more) {
    :root {
      --color-accent: #986d00;
    }
  }

  @media (prefers-color-scheme: dark) {
    :root {
      --image-filter: brightness(0.8) contrast(1);

      --hero-gradient: linear-gradient(
        to top,
        rgb(0 0 0 / 20%),
        rgb(0 0 0 / 10%) 20%,
        transparent 25%,
        transparent 80%,
        rgb(0 0 0 / 10%) 85%,
        rgb(0 0 0 / 20%) 100%
      );

      --drop-shadow-sm: 0 1px 2px rgb(0 0 0 / 80%);
      --drop-shadow-md: 0 3px 3px rgb(0 0 0 / 80%);
      --drop-shadow-2xl: 0 25px 25px rgb(0 0 0 / 65%);
      --drop-shadow-lg: 0 4px 4px rgb(0 0 0 / 25%);
    }
  }

  @media (width >= theme(--breakpoint-tablet)) {
    :root {
      --container-padding: 48px;
      --list-item-poster-width: 76px;
    }
  }

  @media (width >= theme(--breakpoint-laptop)) {
    :root {
      --container-padding: 80px;
      --list-item-poster-width: 80px;
    }
  }

  @font-face {
    font-display: swap;
    font-family: Assistant;
    font-style: normal;
    font-weight: 200 800;
    src: url("/fonts/Assistant/Assistant.woff2") format("woff2");
  }

  @font-face {
    font-display: swap;
    font-family: Assistant;
    font-weight: 200 800;
    src: url("/fonts/Assistant/AssistantSymbols_Return.woff2") format("woff2");
    unicode-range: U+21A9; /* Only for the return arrow */
  }

  @font-face {
    font-display: swap;
    font-family: Assistant;
    font-weight: 200 800;
    src: url("/fonts/Assistant/AssistantSymbols_LeftRight.woff2")
      format("woff2");
    unicode-range: U+2190, U+2192; /* Left and Right arrows */
  }

  @font-face {
    font-display: swap;
    font-family: FrankRuhlLibre;
    font-style: normal;
    font-weight: 300 900;
    src: url("/fonts/Frank-Ruhl-Libre/Frank-Ruhl-Libre_latin_300-900_normal.woff2")
      format("woff2");
    unicode-range:
      U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC,
      U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191,
      U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
  }
}

@utility bg-progress-bar {
  background-image: linear-gradient(
    to right,
    var(--background-color-progress),
    var(--background-color-progress) var(--bar-percent),
    transparent var(--bar-percent),
    transparent
  );
  opacity: 0.33;
}

@utility leading-normal {
  &.rendered-markdown {
    p {
      margin-bottom: 21px;
    }
  }
}

@utility select-background-image {
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' fill='%23054a93' height='20' width='20' viewBox='0 0 20 20' aria-hidden='true' focusable='false'><path d='M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z'></path></svg>");
  background-position-x: calc(100% - 8px);
  background-position-y: 8px;
  background-repeat: no-repeat;
}

@utility safari-border-radius-fix {
  transform: translateZ(0);
}

@utility scrollbar-hidden {
  scrollbar-width: none;

  &::-webkit-scrollbar {
    height: 0;
    width: 0;
  }
}

@layer components {
  .range-input {
    appearance: none;
    background: transparent;
    cursor: pointer;
    height: 100%;
    left: 0;
    pointer-events: none;
    position: absolute;
    top: 0;
    width: 100%;
  }

  .range-input::-webkit-slider-thumb {
    appearance: none;
    background-color: var(--background-color-accent);
    border: 2px solid var(--background-color-default);
    border-radius: 50%;
    box-shadow: 0 1px 3px rgb(0 0 0 / 20%);
    cursor: grab;
    height: 1rem;
    pointer-events: auto;
    width: 1rem;
  }

  .range-input::-webkit-slider-thumb:active {
    cursor: grabbing;
  }

  .range-input::-webkit-slider-thumb:hover {
    box-shadow: 0 2px 4px rgb(0 0 0 / 30%);
  }

  .range-input::-webkit-slider-thumb:focus {
    outline: 2px solid var(--color-accent);
    outline-offset: 2px;
  }

  .range-input::-moz-range-thumb {
    background-color: var(--background-color-accent);
    border: 2px solid var(--background-color-default);
    border-radius: 50%;
    box-shadow: 0 1px 3px rgb(0 0 0 / 20%);
    cursor: grab;
    height: 1rem;
    pointer-events: auto;
    width: 1rem;
  }

  .range-input::-moz-range-thumb:active {
    cursor: grabbing;
  }

  .range-input::-moz-range-thumb:hover {
    box-shadow: 0 2px 4px rgb(0 0 0 / 30%);
  }

  .range-input::-moz-range-thumb:focus {
    outline: 2px solid var(--color-accent);
    outline-offset: 2px;
  }

  .rendered-markdown {
    a {
      text-decoration: underline;
      text-decoration-thickness: 1px;
      transition: all 150ms ease-out;
    }

    sup a,
    .data-footnote-backref {
      color: var(--color-accent);
      text-decoration-thickness: auto;
    }

    .data-footnote-backref {
      display: inline-block;
      position: relative;
      text-decoration: none;
    }

    .data-footnote-backref::after {
      background-color: var(--background-color-accent);
      bottom: 1px;
      content: "";
      height: 1px;
      left: 0;
      position: absolute;
      transform: scale(0, 1);
      transform-origin: center;
      transition: all;
      transition-duration: 500ms;
      width: 100%;
    }

    .data-footnote-backref:hover::after {
      transform: scale(1, 1);
    }

    sup a {
      font-weight: 600;
      margin-right: 0.5ch;
    }

    a:hover {
      color: var(--color-accent);
      transition: all 250ms ease-in-out;
    }

    sup a:hover {
      background-color: var(--background-color-accent);
      border-color: transparent;
      color: var(--color-white);
      filter: drop-shadow(0 1px 2px rgb(0 0 0 / 15%));
    }

    sup:hover {
      transform: scale(1.1);
      transition: all;
      transition-duration: 500ms;
    }

    p {
      margin-bottom: 24px;
    }

    strong {
      font-weight: bold;
    }

    blockquote {
      border-left: 0.5rem solid var(--border-default);
      color: var(--fg-muted);
      font-style: italic;
      margin: 24px 0;
      padding: 0 24px;
      position: relative;
      quotes: "\\201C" "\\201D" "\\2018" "\\2019";
    }

    h1,
    h2,
    h3 {
      line-height: 1.1;
      margin-top: 1.5rem;
    }

    h2 {
      font-size: 24px;
      font-weight: 600;
      line-height: 24px;
      margin-bottom: 8px;
    }

    h3 {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 0.25rem;
    }

    hr {
      border: 1px solid var(--border-default);
      margin: 39px auto;
      width: 75%;
    }

    img {
      height: 1.125rem;
      margin-bottom: 6px;
      width: auto;
    }

    p:last-child {
      margin-bottom: 0;
    }

    ol {
      list-style-type: decimal;
      padding-left: 1.4rem;
    }

    ul {
      list-style-type: none;
      padding-left: 1.4rem;
    }

    > ul {
      padding-left: 0;
    }

    li {
      line-height: 28px;
      margin-bottom: 1.4rem;
    }

    .footnotes {
      box-shadow: 0 -1px var(--border-default);
      font-size: 1rem;
      margin-top: 3.5rem;
      padding-top: 2rem;

      h2 {
        margin-bottom: 1.5rem;
      }

      ol {
        list-style-type: none;
        position: relative;
      }

      li {
        font-family: var(--font-sans);
        font-size: 16px;
        font-weight: 400;
        line-height: 1.5rem;
      }

      li::before {
        content: counter(list-item);
        display: block;
        font-family: var(--font-serif);
        position: absolute;
        right: calc(100% + 0.25em);
        text-align: right;
      }
    }
  }
}
